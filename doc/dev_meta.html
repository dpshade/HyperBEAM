<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.35.1">
    <meta name="project" content="hb v0.0.1">


    <title>dev_meta â€” hb v0.0.1</title>
    <link rel="stylesheet" href="dist/html-erlang-4IXSOGMD.css" />


    <script src="dist/handlebars.runtime-NWIB6V2M.js"></script>
    <script src="dist/handlebars.templates-K7URE6B4.js"></script>
    <script src="dist/sidebar_items-BF2C6ECE.js"></script>
    <script src="docs_config.js"></script>
    <script async src="dist/html-PVRIOB7F.js"></script>

  </head>
  <body data-type="modules" class="page-module">
    <script>

      try {
        var settings = JSON.parse(localStorage.getItem('ex_doc:settings') || '{}');

        if (settings.theme === 'dark' ||
           ((settings.theme === 'system' || settings.theme == null) &&
             window.matchMedia('(prefers-color-scheme: dark)').matches)
           ) {
          document.body.classList.add('dark')
        }
      } catch (error) { }
    </script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

      <div>
        <a href="readme.html" class="sidebar-projectName" translate="no">
hb
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v0.0.1
        </div>
      </div>
    </div>
    <ul id="sidebar-listNav" class="sidebar-listNav" role="tablist">
      <li>
        <button id="extras-list-tab-button" role="tab" data-type="extras" aria-controls="extras-tab-panel" aria-selected="true" tabindex="0">
Pages
        </button>
      </li>

        <li>
          <button id="modules-list-tab-button" role="tab" data-type="modules" aria-controls="modules-tab-panel" aria-selected="false" tabindex="-1">
            Modules
          </button>
        </li>


    </ul>
  </div>

  <div id="extras-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="extras-list-tab-button">
    <ul id="extras-full-list" class="full-list"></ul>
  </div>

    <div id="modules-tab-panel" class="sidebar-tabpanel" role="tabpanel" aria-labelledby="modules-list-tab-button" hidden>
      <ul id="modules-full-list" class="full-list"></ul>
    </div>


</nav>

<main class="content">
  <output role="status" id="toast"></output>

  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of hb</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search">
            <i class="ri-search-2-line ri-lg" aria-hidden="true" title="Submit search"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

    <span translate="no">dev_meta</span> 
    <small class="app-vsn" translate="no">(hb v0.0.1)</small>

  </h1>


    <section id="moduledoc">
<p>The hyperbeam meta device, which is the default entry point
for all messages processed by the machine. This device executes a
AO-Core singleton request, after first applying the node's 
pre-processor, if set. The pre-processor can halt the request by
returning an error, or return a modified version if it deems necessary --
the result of the pre-processor is used as the request for the AO-Core
resolver. Additionally, a post-processor can be set, which is executed after
the AO-Core resolver has returned a result.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#adopt_node_message/2" data-no-tooltip translate="no">adopt_node_message(Request, NodeMsg)</a>

      </div>

        <div class="summary-synopsis"><p>Attempt to adopt changes to a node message.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#authorized_set_node_msg_succeeds_test/0" data-no-tooltip translate="no">authorized_set_node_msg_succeeds_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that we can set the node message if the request is signed by the
owner of the node.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#claim_node_test/0" data-no-tooltip translate="no">claim_node_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that we can claim the node correctly and set the node message after.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#config_test/0" data-no-tooltip translate="no">config_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that we can get the node message.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#halt_request_test/0" data-no-tooltip translate="no">halt_request_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that we can halt a request if the preprocessor returns an error.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handle/2" data-no-tooltip translate="no">handle(NodeMsg, RawRequest)</a>

      </div>

        <div class="summary-synopsis"><p>Normalize and route messages downstream based on their path. Messages
with a <code class="inline">Meta</code> key are routed to the <code class="inline">handle_meta/2</code> function, while all
other messages are routed to the <code class="inline">handle_resolve/2</code> function.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#info/1" data-no-tooltip translate="no">info/1</a>

      </div>

        <div class="summary-synopsis"><p>Ensure that the helper function <a href="#adopt_node_message/2"><code class="inline">adopt_node_message/2</code></a> is not exported.
The naming of this method carefully avoids a clash with the exported <a href="#info/3"><code class="inline">info/3</code></a>
function. We would like the node information to be easily accessible via the
<code class="inline">info</code> endpoint, but AO-Core also uses <code class="inline">info</code> as the name of the function
that grants device information. The device call takes two or fewer arguments,
so we are safe to use the name for both purposes in this case, as the user 
info call will match the three-argument version of the function. If in the 
future the <code class="inline">request</code> is added as an argument to AO-Core's internal <code class="inline">info</code>
function, we will need to find a different approach.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#info/3" data-no-tooltip translate="no">info/3</a>

      </div>

        <div class="summary-synopsis"><p>Get/set the node message. If the request is a <code class="inline">POST</code>, we check that the
request is signed by the owner of the node. If not, we return the node message
as-is, aside all keys that are private (according to <code class="inline">hb_private</code>).</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#modify_request_test/0" data-no-tooltip translate="no">modify_request_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that a preprocessor can modify a request.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#permanent_node_message_test/0" data-no-tooltip translate="no">permanent_node_message_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that a permanent node message cannot be changed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#priv_inaccessible_test/0" data-no-tooltip translate="no">priv_inaccessible_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that we can't get the node message if the requested key is private.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#unauthorized_set_node_msg_fails_test/0" data-no-tooltip translate="no">unauthorized_set_node_msg_fails_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that we can't set the node message if the request is not signed by
the owner of the node.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#uninitialized_node_test/0" data-no-tooltip translate="no">uninitialized_node_test()</a>

      </div>

        <div class="summary-synopsis"><p>Test that an uninitialized node will not run computation.</p></div>

    </div>

</div>

  </section>


  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="adopt_node_message/2">

  <div class="detail-header">
    <a href="#adopt_node_message/2" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">adopt_node_message(Request, NodeMsg)</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L168" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Attempt to adopt changes to a node message.</p>
  </section>
</section>
<section class="detail" id="authorized_set_node_msg_succeeds_test/0">

  <div class="detail-header">
    <a href="#authorized_set_node_msg_succeeds_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">authorized_set_node_msg_succeeds_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L400" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that we can set the node message if the request is signed by the
owner of the node.</p>
  </section>
</section>
<section class="detail" id="claim_node_test/0">

  <div class="detail-header">
    <a href="#claim_node_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">claim_node_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L485" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that we can claim the node correctly and set the node message after.</p>
  </section>
</section>
<section class="detail" id="config_test/0">

  <div class="detail-header">
    <a href="#config_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">config_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L353" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that we can get the node message.</p>
  </section>
</section>
<section class="detail" id="halt_request_test/0">

  <div class="detail-header">
    <a href="#halt_request_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">halt_request_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L550" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that we can halt a request if the preprocessor returns an error.</p>
  </section>
</section>
<section class="detail" id="handle/2">

  <div class="detail-header">
    <a href="#handle/2" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">handle(NodeMsg, RawRequest)</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L34" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Normalize and route messages downstream based on their path. Messages
with a <code class="inline">Meta</code> key are routed to the <code class="inline">handle_meta/2</code> function, while all
other messages are routed to the <code class="inline">handle_resolve/2</code> function.</p>
  </section>
</section>
<section class="detail" id="info/1">

  <div class="detail-header">
    <a href="#info/1" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">info/1</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L27" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Ensure that the helper function <a href="#adopt_node_message/2"><code class="inline">adopt_node_message/2</code></a> is not exported.
The naming of this method carefully avoids a clash with the exported <a href="#info/3"><code class="inline">info/3</code></a>
function. We would like the node information to be easily accessible via the
<code class="inline">info</code> endpoint, but AO-Core also uses <code class="inline">info</code> as the name of the function
that grants device information. The device call takes two or fewer arguments,
so we are safe to use the name for both purposes in this case, as the user 
info call will match the three-argument version of the function. If in the 
future the <code class="inline">request</code> is added as an argument to AO-Core's internal <code class="inline">info</code>
function, we will need to find a different approach.</p>
  </section>
</section>
<section class="detail" id="info/3">

  <div class="detail-header">
    <a href="#info/3" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">info/3</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L69" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Get/set the node message. If the request is a <code class="inline">POST</code>, we check that the
request is signed by the owner of the node. If not, we return the node message
as-is, aside all keys that are private (according to <code class="inline">hb_private</code>).</p>
  </section>
</section>
<section class="detail" id="modify_request_test/0">

  <div class="detail-header">
    <a href="#modify_request_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">modify_request_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L569" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that a preprocessor can modify a request.</p>
  </section>
</section>
<section class="detail" id="permanent_node_message_test/0">

  <div class="detail-header">
    <a href="#permanent_node_message_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">permanent_node_message_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L438" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that a permanent node message cannot be changed.</p>
  </section>
</section>
<section class="detail" id="priv_inaccessible_test/0">

  <div class="detail-header">
    <a href="#priv_inaccessible_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">priv_inaccessible_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L362" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that we can't get the node message if the requested key is private.</p>
  </section>
</section>
<section class="detail" id="unauthorized_set_node_msg_fails_test/0">

  <div class="detail-header">
    <a href="#unauthorized_set_node_msg_fails_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">unauthorized_set_node_msg_fails_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L378" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that we can't set the node message if the request is not signed by
the owner of the node.</p>
  </section>
</section>
<section class="detail" id="uninitialized_node_test/0">

  <div class="detail-header">
    <a href="#uninitialized_node_test/0" class="detail-link" data-no-tooltip aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <h1 class="signature" translate="no">uninitialized_node_test()</h1>

      <a href="https://github.com/permaweb/HyperBEAM/blob/v0.0.1/src/dev_meta.erl#L429" class="icon-action" rel="help" aria-label="View Source">
       <i class="ri-code-s-slash-line" aria-hidden="true"></i>
     </a>


  </div>

  <section class="docstring">

<p>Test that an uninitialized node will not run computation.</p>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

          <span class="line">
            <a href="https://hex.pm/packages/hb/0.0.1" class="footer-hex-package">Hex Package</a>

            <a href="https://preview.hex.pm/preview/hb/0.0.1">Hex Preview</a>

          </span>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="hb.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.35.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>

    </footer>
  </div>
</main>
</div>

  </body>
</html>
